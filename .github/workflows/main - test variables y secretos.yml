name: test variables y secretos

on:
  push:
    branches:
      - main

jobs:
  cancelarEjecucionesEnCurso:
    runs-on: ubuntu-latest
    steps:
      - name: "cancelaci√≥n"
        uses: styfle/cancel-workflow-action

  variablesEntornoCodigoMatrix:
    needs: cancelarEjecucionesEnCurso
    strategy:
      matrix:
        operating_system: ['self-hosted, alvarinchu1', ubuntu-latest, windows-, macos]
    runs-on: ${{ matrix.operating_system }}
    env:
      v1: 'variable desde codigo'
    steps:
      - run: echo variable dede codigo ${{ env.v1 }}

  variablesEntornoConfigRepo:  
    needs: variablesEntornoCodigoMatrix
    runs-on: [self-hosted, macos]
    steps:
      - run: echo variable desde repo ${{ vars.V2 }}

  secretosNivelRepo:
    runs-on: ubuntu-latest
    needs: variablesEntornoCodigoMatrix
    steps:
      - run: echo secreto S1 ${{ secrets.S1 }}

  secretosNivelRepoEnv:
    needs: secretosNivelRepo
    environment: test
    runs-on: ubuntu-latest    
    steps:      
      - run: echo secreto S1 ${{ secrets.S1 }}      
      - run: echo secreto S2 no existe a nivel entorno ${{ secrets.S2 }}